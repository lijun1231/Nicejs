(function(){function e(){return new e.prototype.init}var t=this;return e.prototype.init=function(){var e=this;return this.cc=function(){},e},e.prototype.niceBone=function(){var t=this,n=arguments[0]||{};return t.maxPageCount=+n.maxPageCount||5,t.test=n.test||null,t.currPage=null,t.pFn={},t.exFn=[],t.preFn=[],t.hFn=[],t.hxFn=[],t.beforeRender=null,t.plen=0,t.sync=!0,t.device=e.getDevice(),t.hash=window.location.hash?window.location.hash.substr(1):"main",t.cateHash=null,t.cateHash_=null,t.dStr="",t.pages={},t.temps={},t.arrLine=[],t.cont=function(){var e=document.querySelector("bone");return e||(e=document.createElement("bone"),e.setAttribute("nc-version","1.0"),e.setAttribute("nc-name","_"),document.body.appendChild(e)),e}(),t.docTitle=function(){var e=document.getElementById("nc-doc-title");return e||(e=document.createElement("div"),document.body.appendChild(e)),e.style.position="absolute",e.id="nc-doc-title",e.style.width="1px",e.style.height="1px",e.style.opacity="0",e}(),t.oVersion={v:t.cont.getAttribute("nc-version"),name:t.cont.getAttribute("nc-name"),title:document.title},t.domCtl=function(){return document.head.querySelector("#__domRevManifest")?(document.head.querySelector("#__domRevManifest").remove(),__domRevManifest):null}(),t},e.create=function(){var t=new e.prototype.niceBone,n=t.pages=function(){var e=t.cont.querySelectorAll("page"),n={};if(0===e.length)return{};t.staticPageCount=e.length;for(var o=0;o<t.staticPageCount;o++)n=e[o],t.pages[n.getAttribute("nc-name")]={id:n.getAttribute("nc-name"),title:n.getAttribute("nc-title")||t.oVersion.title,0:n,"static":!0};return t.pages}();t.cont;return t.extendBeforeShow=function(e){t.preFn.push(e)},t.extendAfterShow=function(e){t.exFn.push(e)},t.extendBeforeRender=function(e){t.beforeRender=e},t.extendBeforeHide=function(e){t.hFn.push(e)},t.extendAfterHide=function(e){t.hxFn.push(e)},t.template=function(n,o){t.temps[n]={0:function(){t.cont_temp=function(){var e=document.getElementById("nc-component");return e||(e=document.createElement("div"),e.id="nc-component",document.body.appendChild(e)),e}()}(),id:n,loaded:!1,cb:o,hide:function(){e.removeClass(this[0],"on");for(var n=0,o=t.temps.length;n<o;n++){var i=t.temps[n][0];if(e.hasClass(i,"on"))return}e.removeClass(t.cont_temp,"on")},show:function(){var n=this;this.loaded?(e.addClass(t.cont_temp,"on"),e.addClass(n[0],"on"),this.cb(function(){t.compilePage(n)})):t.loadPage(this.id,function(e){n[0]=t.createPage({"data-temp":n.id},!0),n.html=e,n[0].innerHTML=e,n.loaded=!0,n.show()})}}},t.extend=function(){var n={};if("object"==typeof arguments[0])n=arguments[0],t.pFn[n.id]={},t.pFn[n.id].init=n.init,t.pFn[n.id].beforeShow=n.beforeShow,t.pFn[n.id].afterShow=n.afterShow,t.pFn[n.id].beforeHide=n.beforeHide,t.pFn[n.id].afterHide=n.afterHide,t.pFn[n.id].unload=n.unload,n.title=n.title||t.oVersion.title,n.res=n.res||null;else{var o=arguments[arguments.length-1];n={id:arguments[0],title:"string"==typeof arguments[1]?arguments[1]:t.oVersion.title,res:"function"==typeof o?null:o},t.pFn[n.id]={},"function"==typeof o?t.pFn[n.id].afterShow=o:"object"==typeof o?t.pFn[n.id].afterShow=arguments[arguments.length-2]:t.pFn[n.id].afterShow=function(){}}var i=t.pages[n.id];i?i["static"]&&(i.title=i.title||n.title):i=t.pages[n.id]={id:n.id,title:n.title},i.loaded=!1,i.hooks=[],i.opt=function(){if(!n.res)return null;var e={};return n.res.js&&0!==n.res.js.length&&("object"==typeof n.res.js[0]?e.js={pre:{loaded:!1,arr:t.iniRes(n.res.js[0])},res:{loaded:!1,arr:t.iniRes(n.res.js.slice(1))}}:e.js={res:{loaded:!1,arr:t.iniRes(n.res.js)}}),n.res.style&&0!==n.res.style.length&&(e.style={res:{loaded:!1,arr:t.iniRes(n.res.style)}}),e}(),i.hide=function(){var n=t.pFn[this.id];n.beforeHide&&n.beforeHide(this),e.conductFunctions.call(null,t.hFn,this),e.removeClass(this[0],"on"),n.afterHide&&n.afterHide(this),e.conductFunctions.call(null,t.hxFn,this)},i.show=function(){var n=t.pFn[this.id];n.beforeShow&&n.beforeShow(this),e.addClass(this[0],"on"),t.beforeRender&&t.beforeRender(this),t.sync?this.render():t.sync=!0},i.render=function(){var n=this,o=t.pFn[n.id];e.conductFunctions.call(null,t.preFn,n),o.afterShow&&(n.opt?(t.loadRes(!(n.opt.js&&n.opt.js.pre)||n.opt.js.pre,function(){o.afterShow.call(n,function(){t.loadRes(!(n.opt.js&&n.opt.js.res)||n.opt.js.res,function(){t.compileHook(n),t.compilePage(n)})},n)}),!n.opt.style||t.loadRes(n.opt.style.res)):o.afterShow&&o.afterShow.call(n,function(){t.compileHook(n),t.compilePage(n)},n))},i.restore=function(){this[0].innerHTML=this.html,this.render()},i.hook=function(e){this.hooks.push(e)}},t.iniRes=function(e){for(var n=[],o=0,i=e.length;o<i;o++)n.push({0:function(e){if(t.domCtl&&!/:\/\//.test(e)){var n=e.match(/\/\w*\./),o=e.substr(e.lastIndexOf(".")+1),i=e.substr(n.index+1,n[0].length-2),a=t.domCtl[o][i];return e.replace(/\/\w*\./,"/"+a+".")}return e}(e[o]),loaded:!1,dom:null});return n},t.setTitle=function(e){if("ios"!==t.device.plat)document.title=e;else{document.title=e;var n=document.createElement("iframe");n.setAttribute("src","images/x.png"),n.onload=function(){setTimeout(function(){t.docTitle.removeChild(n)})},t.docTitle.appendChild(n)}},t.iniPages=function(){try{t.loadByHash()}catch(e){}window.addEventListener("hashchange",function(){t.hash=window.location.hash?window.location.hash.substr(1):"main",t.loadByHash()},!1),document.addEventListener("click",function(e){var n=e.target;if(p=n.closest("[nc-href]",!0),p){var o=p.getAttribute("nc-href"),i=p.getAttribute("sync");t.sync="false"!==i,t.changeHash(o,t.sync)}},!1)},t.gotoPage=function(e){var o=e.split("/"),i={};i.v=function(){return o[0].split("=")[1]||o[0].split("=")[0]}();for(var a=1;a<o.length;a++){var r=o[a].split("=");i[r[0]]=r[1]}t.cateHash_=t.cateHash,t.cateHash=i;var s=function(e){var o=n[t.cateHash.v],i=t.currPage;i&&i.id===o.id?t.currPage.show(t.cateHash):(t.currPage=o,t.setTitle(t.currPage.title),o.loaded?t.currPage.show(t.cateHash):(o["static"]?(o.html={html:o[0].innerHTML},t.extend(t.cateHash.v,function(e){e()})):(o[0]=t.createPage({"nc-name":o.id,"nc-title":o.title}),o.html={html:e},o[0].innerHTML=e),o.loaded=!0,t.pFn[o.id].init&&t.pFn[o.id].init(o),t.currPage.show(t.cateHash))),i&&i!=o&&i.hide(),t.forLoad(!0)};!function(){var e=t.pages[t.cateHash.v];e&&e["static"]||e&&e.html?s():t.loadPage(t.cateHash.v,function(n){e||t.extend(t.cateHash.v,function(e){e()}),s(n)})}()},t.loadPage=function(n,o){var i="views/"+(t.domCtl?t.domCtl.views[n]:n)+".html"+(t.test?"?v="+e.createRandomAlphaNum(5):"");e.ajax({url:i,type:"get",dataType:"string",callback:function(e){o(e)}})},t.loadRes=function(n,o){if(n===!0||n.loaded)return!o||o();var i=n.arr;if(/.js$/.test(i[0][0])){var a=0,r=i.length;!function(){if(a>=r)return n.loaded=!0,o();var s=arguments.callee,c=i[a++];if(c.loaded)return s();var d=document.createElement("script");d.src=c[0]+(t.domCtl?"":t.test?"?v="+e.createRandomAlphaNum(5):"");try{d.onload=function(){return c.loaded=!0,c.dom=this,s()}}catch(l){}document.body.appendChild(d)}()}else/.css$/.test(i[0][0])&&!function(){for(var a=i.length,r=0,s=0;s<a;s++)i[s].loaded?r++:!function(s){var c=document.createElement("link");c.rel="stylesheet",c.href=i[s][0]+(t.domCtl?"":"?v="+e.createRandomAlphaNum(5)),c.onload=function(){if(i[s].loaded=!0,i[s].dom=c,r++,r>=a)return n.loaded=!0,!o||o()},document.head.appendChild(c)}(s)}()},t.loadByHash=function(){t.gotoPage(t.hash)},t.changeHash=function(e,n){var o=function(){if(/^\-/.test(e)){var n=e.substr(1),o=new RegExp("/"+n+"="+t.cateHash[n],"");e=t.hash.replace(o,"")}else if(/^\+/.test(e))e=t.hash+"/"+e.substr(1);else if(/^\^/.test(e)){var n=e.substr(1).split("=");if(t.cateHash[n[0]]){var o=new RegExp("/"+n[0]+"="+t.cateHash[n[0]]);e=t.hash.replace(o,"/"+n[0]+"="+n[1])}else e=t.hash+"/"+n[0]+"="+n[1]}return e}();window.location.hash=o,t.sync=n!==!1||n},t.createPage=function(e,n){var o=document.createElement("page");for(var i in e)o.setAttribute(i,e[i]);return t[n?"cont_temp":"cont"].appendChild(o),o},t.forLoad=function(e){if(!t.currPage["static"]){var n=t.currPage,o=t.arrLine;if(e){for(var i=0;i<o.length;i++)o[i]===n.id&&o.splice(i,1);o.unshift(n.id)}else o.splice(0,0,n.id);if(o.length>t.maxPageCount){for(var a=t.maxPageCount;a<o.length;a++){var r=t.pages[o[a]];r.unload&&r.unload(r),t.cont.removeChild(r[0]),r.loaded=!1}o.splice(t.maxPageCount)}}},t.compileHook=function(e){if(0!==e.hooks.length)for(var t=0;t<e.hooks.length;t++)e.hooks[t](e)},t.compilePage=function(n){var n=n||t.currPage;"PAGE"===n[0].tagName&&e.addClass(n[0],"ready"),e.conductFunctions.call(null,t.exFn,n)},setTimeout(function(){t.iniPages()}),t},e.conductFunctions=function(e,t){if("function"==typeof e)e(t);else if(0!==e.length)for(var n=0,o=e.length;n<o;n++)e[n](t)},e.ajax=function(e){var t=e.callback||function(){},n=e.paras||"",o=e.type||"POST",i=e.async!==!1,a=e.dataType||"json",r=e.url;if("jsonp"===a){var s=e.jsonpCallbackName||"callback",c=e.jsonpCallback||"_"+(new Date).getTime();if(r+=(e.url.indexOf("?")===-1?"?":"&")+s+"="+c,n)for(var d in n)r+="&"+d+"="+n[d];window[c]=t;var l=document.createElement("script");return l.src=r,l.onload=function(){document.head.removeChild(l),delete window[c]},void document.head.insertBefore(l,document.head.childNodes[0])}var u;if(u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXoect("Microsoft.XMLHTTP"),u.onreadystatechange=function(){var e=null;4==u.readyState&&200==u.status&&(e=u.responseText,"json"==a&&(e=JSON.parse(e)),t(e))},"post"==o){var f="";if("object"==typeof n){for(var p in n)f+=p+"="+n[p]+"&";f=f.replace(/&$/,"")}else"string"==typeof n&&(f=n);u.open("POST",r,i),u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u.send(f)}else{var h="";if(n){var m=function(){var e=!1;for(var t in n)h+="&"+t+"="+n[t],e=!0;return e}();h=m?h.substr(1):h,r+=m?(r.indexOf("?")===-1?"?":"&")+h:""}u.open("GET",r,i),u.send()}return u},e.addClass=function(e,t){if(e instanceof Node){var n=void 0!=document.body.classList;if(n&&e)e.classList.add(t);else if(e&&e instanceof Node){var o=e.className;o?(" "+o+" ").indexOf(" "+t+" ")===-1&&(e.className=o+" "+t):e.className=t}}},e.removeClass=function(e,t){if(e instanceof Node){var n=void 0!=document.body.classList;if(n)e.classList.remove(t);else if(e&&e instanceof Node){var o=" "+e.className+" ",i=new RegExp("(\\s|^)"+cls+"(\\s|$)");e.className=o.replace(i," ")}}},e.toggleClass=function(e,t){var n=this;if(e instanceof Node){var o=void 0!=document.body.classList;o?e.classList.toggle(t):n.hasClass(e,t)?n.removeClass(e,t):n.addClass(e,t)}},e.hasClass=function(e,t){if(!e.className)return!1;var n=" "+e.className+" ",o=" "+t+" ",i=n.match(new RegExp(o));return Boolean(i)||!1},e.createRandomAlphaNum=function(e){for(var t="";t.length<e;t+=Math.random().toString(36).substr(2));return t.substr(0,e)},e.getDevice=function(){var e=function(){var e={ie:0,gecko:0,webkit:0,khtml:0,opera:0,ver:null},t={ie:0,firefox:0,safari:0,konq:0,opera:0,chrome:0,ver:null},n={win:!1,mac:!1,x11:!1,iphone:!1,ipod:!1,ipad:!1,ios:!1,android:!1,nokiaN:!1,winMobile:!1,wii:!1,ps:!1},o=navigator.userAgent;if(window.opera)e.ver=t.ver=window.opera.version(),e.opera=t.opera=parseFloat(e.ver);else if(/AppleWebKit\/(\S+)/.test(o))if(e.ver=RegExp.$1,e.webkit=parseFloat(e.ver),/Chrome\/(\S+)/.test(o))t.ver=RegExp.$1,t.chrome=parseFloat(t.ver);else if(/Version\/(\S+)/.test(o))t.ver=RegExp.$1,t.safari=parseFloat(t.ver);else{var i=1;i=e.webkit<100?1:e.webkit<312?1.2:e.webkit<412?1.3:2,t.safari=t.ver=i}else/KHTML\/(\S+)/.test(o)||/Konqueror\/([^;]+)/.test(o)?(e.ver=t.ver=RegExp.$1,e.khtml=t.konq=parseFloat(e.ver)):/rv:([^\)]+)\) Gecko\/\d{8}/.test(o)?(e.ver=RegExp.$1,e.gecko=parseFloat(e.ver),/Firefox\/(\S+)/.test(o)&&(t.ver=RegExp.$1,t.firefox=parseFloat(t.ver))):/MSIE ([^;]+)/.test(o)&&(e.ver=t.ver=RegExp.$1,e.ie=t.ie=parseFloat(e.ver));t.ie=e.ie,t.opera=e.opera;var a=navigator.platform;if(n.win=0==a.indexOf("Win"),n.mac=0==a.indexOf("Mac"),n.x11="X11"==a||0==a.indexOf("Linux"),n.win&&/Win(?:dows )?([^do]{2})\s?(\d+\.\d+)?/.test(o))if("NT"==RegExp.$1)switch(RegExp.$2){case"5.0":n.win="2000";break;case"5.1":n.win="XP";break;case"6.0":n.win="Vista";break;case"6.1":n.win="7";break;default:n.win="NT"}else"9x"==RegExp.$1?n.win="ME":n.win=RegExp.$1;return n.iphone=o.indexOf("iPhone")>-1,n.ipod=o.indexOf("iPod")>-1,n.ipad=o.indexOf("iPad")>-1,n.nokiaN=o.indexOf("NokiaN")>-1,"CE"==n.win?n.winMobile=n.win:"Ph"==n.win&&/Windows Phone OS (\d+.\d+)/.test(o)&&(n.win="Phone",n.winMobile=parseFloat(RegExp.$1)),n.mac&&o.indexOf("Mobile")>-1&&(/CPU (?:iPhone )?OS (\d+_\d+)/.test(o)?n.ios=parseFloat(RegExp.$1.replace("_",".")):n.ios=2),/Android (\d+\.\d+)/.test(o)&&(n.android=parseFloat(RegExp.$1)),n.wii=o.indexOf("Wii")>-1,n.ps=/playstation/i.test(o),{engine:e,browser:t,system:n}}(),t=!1,n=!1,o=navigator.userAgent.toLowerCase(),i=!1,a=!1;if(o.indexOf("applewebkit")!=-1)if(e.system.iphone||e.system.ipad){n="ios",o.indexOf("6_")!=-1&&(i=6),o.indexOf("7_")!=-1&&(i=7),o.indexOf("8_")!=-1&&(i=8),o.indexOf("8_0")!=-1&&(i=8),o.indexOf("8_1")!=-1&&(i=8.1),o.indexOf("8_2")!=-1&&(i=8.2),o.indexOf("8_3")!=-1&&(i=8.3),o.indexOf("8_4")!=-1&&(i=8.4),o.indexOf("9_")!=-1&&(i=9),t=o.indexOf("micromessenger")!=-1?"ios_weixin":o.indexOf("version")!=-1&&o.indexOf("safari")!=-1?"safari":"desktop";var r=(window.screen.width,window.screen.height);480==r&&(a="iphone4"),568==r&&(a="iphone5"),667==r&&(a="iphone6"),736==r&&(a="iphone6p")}else e.system.android&&(n="android",o.indexOf("micromessenger")!=-1?t="android_weixin":o.indexOf("chrome")!=-1&&(t="chrome"));return{ua:o,platV:i,plat:n,iphoneN:a,uPlat:t}},e.noConflict=function(){return delete t._,e},e.useKey=function(n){return t[n]=e,e},e.use=function(){arguments[0]},e.extendPrototype=function(){var t=arguments[0],n=null;if("string"==typeof t)switch(t=t.toLowerCase()){case"string":n=String.prototype;break;case"number":n=Number.prototype;break;case"array":n=Array.prototype;break;case"object":n=Object.prototype;break;case"dom":n=HTMLElement.prototype}else t&&t.prototype&&(n=t.prototype);if(2===arguments.length&&"object"==typeof arguments[1]){var o=arguments[1];for(var i in o)e.todoExtendPrototype(n,o[i])}else 3===arguments.length&&e.todoExtendPrototype(n,arguments[1],arguments[2])},e.todoExtendPrototype=function(e,t,n){e[t]=n},Array.prototype.getIndex=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1},HTMLElement.prototype.closest=function(t,n){var o=n?this:this.parentNode,i="object"==typeof t||!1,a=document.documentElement,r=!1;if(i)for(;o!==a;){if(o===t)return r=!0,o;o=o.parentNode}else{var s=t.substr(0,1),c="";if("["===s){var d=t.match(/[\w-_\d\.]+/g);c=d[0];var l=d[1]||null,u=""}else c=t.match(/[\w-_\d]+/g)[0];for(;o&&o!==a;){switch(s){case"#":if(o.id===c)return r=!0,o;break;case".":if(e.hasClass(o,c))return r=!0,o;break;case"[":if(u=o.getAttribute(c),u&&(null===l||u===l))return r=!0,o;break;default:if(o.tagName===t)return r=!0,o}o=o.parentNode}}return r?o:null},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports._=e):t._=t.Nice=e,e}).call(this);